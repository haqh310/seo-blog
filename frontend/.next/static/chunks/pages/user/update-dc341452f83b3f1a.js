(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[142],{8498:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/update",function(){return n(5532)}])},9110:function(e,t,n){"use strict";n.d(t,{$D:function(){return f},IU:function(){return l},Nq:function(){return x},YR:function(){return j},_y:function(){return c},c0:function(){return N},ej:function(){return m},gF:function(){return b},uf:function(){return u},xJ:function(){return i}});var o=n(9307),s=n.n(o),r=n(1805),a=n(3346);let c=e=>{401===e.status&&u(()=>{Router.push({pathname:"/signin",query:{message:"Your session is expired. Please signin"}})})},l=e=>s()("".concat(a.bl,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>console.log(e)),i=e=>s()("".concat(a.bl,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>console.log(e)),u=e=>(d("token"),g("user"),e(),s()("".concat(a.bl,"/signout"),{method:"GET"}).then(e=>{console.log("signout success")}).catch(e=>console.log(e))),h=(e,t)=>{r.Z.set(e,t,{expires:1})},d=(e,t)=>{r.Z.remove(e,{expires:1})},m=e=>r.Z.get(e),p=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},g=e=>{localStorage.removeItem(e)},j=(e,t)=>{h("token",e.token),p("user",e.user),t()},f=()=>{{let e=m("token");if(e)return!!localStorage.getItem("user")&&JSON.parse(localStorage.getItem("user"))}},x=(e,t)=>{if(localStorage.getItem("user")){let n=JSON.parse(localStorage.getItem("user"));n=e,localStorage.setItem("user",JSON.stringify(n)),t()}},b=e=>s()("".concat(a.bl,"/forgot-password"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>console.log(e)),N=e=>s()("".concat(a.bl,"/reset-password"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>console.log(e))},448:function(e,t,n){"use strict";n.d(t,{Ch:function(){return u},FH:function(){return i},T7:function(){return m},Vh:function(){return l},W1:function(){return h},mx:function(){return g},pb:function(){return d},zZ:function(){return p}});var o=n(9307),s=n.n(o),r=n(7563),a=n(3346),c=n(9110);let l=(e,t)=>{let n;return(0,c.$D)()&&1===(0,c.$D)().role?n="".concat(a.bl,"/blog"):(0,c.$D)()&&0===(0,c.$D)().role&&(n="".concat(a.bl,"/user/blog")),s()("".concat(n),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)},body:e}).then(e=>(console.log(e),(0,c._y)(e),e.json())).catch(e=>console.log(e))},i=(e,t)=>fetch("".concat(a.bl,"/blogs-categories-tags"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({limit:t,skip:e})}).then(e=>e.json()).catch(e=>console.log(e)),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return s()("".concat(a.bl,"/blog/").concat(e),{method:"GET"}).then(e=>e.json()).catch(e=>console.log(e))},h=e=>s()("".concat(a.bl,"/blogs/related"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>console.log(e)),d=e=>{let t;return t=e?"".concat(a.bl,"/").concat(e,"/blogs"):"".concat(a.bl,"/blogs"),s()("".concat(t),{method:"GET"}).then(e=>e.json()).catch(e=>console.log(e))},m=(e,t)=>{let n;let o=(0,c.$D)();return o&&(n=1===o.role?"".concat(a.bl,"/blog/").concat(e):"".concat(a.bl,"/user/blog/").concat(e)),s()("".concat(n),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(e=>((0,c._y)(e),e.json())).catch(e=>console.log(e))},p=(e,t,n)=>{let o;let r=(0,c.$D)();return r&&(o=1===r.role?"".concat(a.bl,"/blog/").concat(n):"".concat(a.bl,"/user/blog/").concat(n)),s()("".concat(o),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)}}).then(e=>((0,c._y)(e),e.json())).catch(e=>console.log(e))},g=e=>{console.log("search param ",e);let t=r.stringify(e);return console.log("query param ",e),s()("".concat(a.bl,"/blogs/search?").concat(t),{method:"GET"}).then(e=>e.json()).catch(e=>console.log(e))}},147:function(e,t,n){"use strict";n.d(t,{Ai:function(){return l},Vx:function(){return i},bn:function(){return c}});var o=n(9307),s=n.n(o),r=n(3346),a=n(9110);let c=e=>s()("".concat(r.bl,"/user/").concat(e),{method:"GET",headers:{Accept:"application/json"}}).then(e=>e.json()).catch(e=>console.log(e)),l=e=>s()("".concat(r.bl,"/user/profile"),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(e)}}).then(e=>e.json()).catch(e=>console.log(e)),i=(e,t)=>s()("".concat(r.bl,"/user/update"),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(e)},body:t}).then(e=>((0,a._y)(e),e.json())).catch(e=>console.log(e))},4592:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var o=n(5893),s=n(7294),r=n(4865),a=n.n(r),c=n(3346),l=n(9110),i=n(450),u=n(1163),h=n.n(u),d=n(1664),m=n.n(d);n(2252);var p=n(448);let g=()=>{let[e,t]=(0,s.useState)({search:void 0,results:[],searched:!1,message:""}),{search:n,results:r,searched:a,message:c}=e,l=o=>{o.preventDefault(),(0,p.mx)({search:n}).then(n=>{n.error?console.log(n.error):t({...e,results:n,searched:!0,message:"".concat(n.length," blogs found.")})})},i=n=>{t({...e,search:n.target.value,searched:!1,results:[]})};return(0,o.jsxs)("div",{className:"container-fluid",children:[(0,o.jsx)("div",{className:"pt-3 pb-5",children:(0,o.jsx)("form",{onSubmit:l,children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-md-9",children:(0,o.jsx)("input",{type:"search",className:"form-control",placeholder:"Search blogs",onChange:i})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)("button",{className:"btn btn-block btn-outline-primary",type:"submit",children:"Search"})})]})})}),a&&(0,o.jsx)("div",{style:{marginTop:"-120px",marginBottom:"-80px"},children:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,o.jsxs)("div",{className:"jumbotron bg-white",children:[c&&(0,o.jsx)("p",{className:"pt-4 text-muted font-italic",children:c}),e.map((e,t)=>(0,o.jsx)("div",{children:(0,o.jsx)(m(),{href:"/blogs/".concat(e.slug),className:"text-primary",children:e.title})},t))]})}(r)})]})};h().onRouteChangeStart=e=>a().start(),h().onRouteChangeComplete=e=>a().done(),h().onRouteChangeError=e=>a().done();let j=()=>{let[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)(),a=()=>t(!e);return(0,s.useEffect)(()=>{r((0,l.$D)())},[]),(0,o.jsxs)(s.Fragment,{children:[(0,o.jsxs)(i.wp,{color:"light",light:!0,expand:"md",className:"px-0",children:[(0,o.jsx)(i.OL,{href:"/",className:"font-weight-bold text-dark",children:c.iC}),(0,o.jsx)(i.WR,{onClick:a}),(0,o.jsx)(i.UO,{isOpen:e,navbar:!0,children:(0,o.jsxs)(i.JL,{className:"ml-auto",navbar:!0,children:[(0,o.jsxs)(s.Fragment,{children:[(0,o.jsx)(i.LY,{children:(0,o.jsx)(i.OL,{href:"/blogs",children:"Blog"})}),(0,o.jsx)(i.LY,{children:(0,o.jsx)(i.OL,{href:"/contact",children:"Contact"})})]}),n?0===n.role?(0,o.jsx)(i.LY,{children:(0,o.jsx)(i.OL,{href:"/user",children:"".concat(n.name,"'s Dashboard")})}):(0,o.jsx)(i.LY,{children:(0,o.jsx)(i.OL,{href:"/admin",children:"".concat(n.name,"'s Dashboard")})}):(0,o.jsx)(i.LY,{children:(0,o.jsx)(i.OL,{href:"/signin",children:"Signin"})}),n&&(0,o.jsx)(i.LY,{children:(0,o.jsx)(i.OL,{style:{cursor:"pointer"},onClick:()=>(0,l.uf)(()=>h().replace("/signin")),children:"Signout"})}),(0,o.jsx)(i.LY,{children:(0,o.jsx)(m(),{href:{pathname:"/user/crud/blog"},className:"btn btn-primary text-light",children:"Write a blog"})})]})})]}),(0,o.jsx)(g,{})]})},f=e=>{let{children:t}=e;return(0,o.jsxs)(s.Fragment,{children:[(0,o.jsx)(j,{}),t]})};var x=f},4645:function(e,t,n){"use strict";var o=n(5893),s=n(7294),r=n(1163),a=n.n(r),c=n(9110);let l=e=>{let{children:t}=e;return(0,s.useEffect)(()=>{(0,c.$D)()||a().push("/signin")},[]),(0,o.jsx)(s.Fragment,{children:t})};t.Z=l},3346:function(e,t,n){"use strict";n.d(t,{CT:function(){return u},bl:function(){return c},f6:function(){return i},iC:function(){return a},yK:function(){return l}});var o=n(1752),s=n.n(o);let{publicRuntimeConfig:r}=s()(),a=r.APP_NAME?r.APP_NAME:"SEOBLOG",c=r.PRODUCTION?r.API_PRODUCTION:r.API_DEVELOPMENT,l=r.PRODUCTION?r.DOMAIN_PRODUCTION:r.DOMAIN_DEVELOPMENT,i=r.FB_APP_ID,u=r.DISQUS_SHORTNAME},5532:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var o=n(5893),s=n(4592),r=n(4645),a=n(7294),c=n(9110),l=n(147),i=n(3346);let u=()=>{let[e,t]=(0,a.useState)(""),[n,s]=(0,a.useState)({username:"",username_for_photo:"",name:"",email:"",about:"",password:"",error:!1,success:!1,loading:!1,photo:"",userData:""}),{username:r,username_for_photo:u,name:h,email:d,about:m,password:p,error:g,success:j,loading:f,photo:x,userData:b}=n,N=(0,c.ej)("token"),y=()=>{(0,l.Ai)(N).then(e=>{e.error?s({...n,error:e.error}):s({...n,username:e.username,username_for_photo:e.username,name:e.name,email:e.email,about:e.about,userData:new FormData})})};(0,a.useEffect)(()=>{y()},[]);let v=e=>o=>{let r="photo"===e?o.target.files[0]:o.target.value;"photo"===e&&t(r.name),b.set(e,r),s({...n,[e]:r,userData:b,error:!1,success:!1})},O=e=>{e.preventDefault(),s({...n,loading:!0}),(0,l.Vx)(N,b).then(e=>{e.error?s({...n,error:e.error,success:!1,loading:!1}):(0,c.Nq)(e,()=>{s({...n,username:e.username,username_for_photo:e.username+"",name:e.name,email:e.email,about:e.about,password:"",success:!0,loading:!1}),t("")})})};return(0,o.jsx)(a.Fragment,{children:(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-md-4",children:(0,o.jsx)("img",{src:"".concat(i.bl,"/user/photo/").concat(u),className:"img img-fluid img-thumbnail mb-3",style:{maxHeight:"auto",maxWidth:"100%"},alt:"user profile"})}),(0,o.jsxs)("div",{className:"col-md-8 mb-5",children:[(0,o.jsx)("div",{className:"alert alert-success",style:{display:j?"":"none"},children:"Profile updated"}),(0,o.jsx)("div",{className:"alert alert-danger",style:{display:g?"":"none"},children:g}),(0,o.jsx)("div",{className:"alert alert-info",style:{display:f?"":"none"},children:"Loading..."}),(0,o.jsxs)("form",{onSubmit:O,children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsxs)("label",{className:"btn btn-outline-info",style:{cursor:"pointer"},children:["Profile photo",(0,o.jsx)("input",{onChange:v("photo"),type:"file",accept:"image/*",hidden:!0})]}),(0,o.jsx)("small",{className:"ml-2",children:e})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{className:"text-muted",children:"Username"}),(0,o.jsx)("input",{onChange:v("username"),type:"text",value:r,className:"form-control"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{className:"text-muted",children:"Name"}),(0,o.jsx)("input",{onChange:v("name"),type:"text",value:h,className:"form-control"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{className:"text-muted",children:"Email"}),(0,o.jsx)("input",{onChange:v("email"),type:"text",value:d,className:"form-control"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{className:"text-muted",children:"About"}),(0,o.jsx)("textarea",{onChange:v("about"),type:"text",value:m,className:"form-control"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{className:"text-muted",children:"Password"}),(0,o.jsx)("input",{onChange:v("password"),type:"text",value:p,className:"form-control"})]}),(0,o.jsx)("div",{children:(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})})]})]})]})})})},h=()=>(0,o.jsx)(s.Z,{children:(0,o.jsx)(r.Z,{children:(0,o.jsx)("div",{className:"container-fluid",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)(u,{})})})})});var d=h}},function(e){e.O(0,[260,928,774,888,179],function(){return e(e.s=8498)}),_N_E=e.O()}]);